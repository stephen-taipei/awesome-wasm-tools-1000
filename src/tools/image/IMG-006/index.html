<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IMG-006 GIF è½‰æ›å™¨ - Awesome WASM Tools 1000</title>
  <meta name="description" content="GIF å‹•ç•«è½‰æ›å·¥å…·ï¼Œæ”¯æ´å¹€æå–èˆ‡ GIF è£½ä½œ">
  <link rel="stylesheet" href="/src/styles/global.css">
  <style>
    .format-selector {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .format-option {
      flex: 1;
      padding: 1rem;
      background: var(--bg-input);
      border: 2px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      text-align: center;
      transition: all 0.2s;
    }
    .format-option:hover {
      border-color: var(--primary);
    }
    .format-option.active {
      border-color: var(--primary);
      background: rgba(99, 102, 241, 0.2);
    }
    .format-option h4 {
      margin-bottom: 0.25rem;
    }
    .format-option p {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }
    .gif-info {
      background: rgba(251, 191, 36, 0.1);
      border: 1px solid var(--warning);
      border-radius: var(--radius);
      padding: 1rem;
      margin-bottom: 1rem;
    }
    .gif-info h4 {
      color: var(--warning);
      margin-bottom: 0.5rem;
    }
    .gif-info p {
      color: var(--text-secondary);
      font-size: 0.9rem;
      margin: 0;
    }
    .frames-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
      gap: 0.5rem;
      margin-top: 1rem;
      max-height: 300px;
      overflow-y: auto;
      padding: 0.5rem;
      background: var(--bg-input);
      border-radius: var(--radius);
    }
    .frame-item {
      position: relative;
      aspect-ratio: 1;
      border: 2px solid var(--border);
      border-radius: 8px;
      overflow: hidden;
      cursor: pointer;
      transition: all 0.2s;
    }
    .frame-item:hover {
      border-color: var(--primary);
    }
    .frame-item.selected {
      border-color: var(--success);
      box-shadow: 0 0 0 2px rgba(34, 197, 94, 0.3);
    }
    .frame-item img {
      width: 100%;
      height: 100%;
      object-fit: contain;
      background: var(--bg-dark);
    }
    .frame-item .frame-number {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 2px;
      background: rgba(0,0,0,0.7);
      color: white;
      font-size: 0.7rem;
      text-align: center;
    }
    .frame-controls {
      display: flex;
      gap: 0.5rem;
      margin-top: 1rem;
      flex-wrap: wrap;
    }
    .frame-controls button {
      padding: 0.5rem 1rem;
      font-size: 0.85rem;
    }
    .delay-setting {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .delay-setting input {
      width: 80px;
      padding: 0.5rem;
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: 8px;
      color: var(--text-primary);
    }
    .multi-upload-info {
      background: rgba(99, 102, 241, 0.1);
      border: 1px solid var(--primary);
      border-radius: var(--radius);
      padding: 0.75rem;
      margin-top: 0.5rem;
      font-size: 0.85rem;
      color: var(--text-secondary);
    }
  </style>
</head>
<body>
  <div class="tool-page">
    <header class="tool-header">
      <a href="/index.html" class="back-btn">
        <span>â†</span>
        <span data-i18n="back">è¿”å›</span>
      </a>
      <div class="tool-title">
        <h1>IMG-006 <span data-i18n="img006_name">GIF è½‰æ›å™¨</span></h1>
        <p data-i18n="img006_desc">GIF å‹•ç•«è½‰æ›ï¼Œæ”¯æ´å¹€æå–èˆ‡è£½ä½œ</p>
      </div>
      <div class="lang-switcher">
        <button onclick="setLanguage('zh-TW')" class="lang-btn">ç¹ä¸­</button>
        <button onclick="setLanguage('en')" class="lang-btn">EN</button>
      </div>
    </header>

    <main class="tool-content">
      <!-- Info Box -->
      <div class="gif-info">
        <h4>ğŸ¬ GIF å‹•ç•«è½‰æ›</h4>
        <p data-i18n="gif_explanation">æ”¯æ´å¾ GIF å‹•ç•«æå–æ‰€æœ‰å¹€ç‚ºéœæ…‹åœ–ç‰‡ï¼Œæˆ–å°‡å¤šå¼µéœæ…‹åœ–ç‰‡åˆæˆç‚º GIF å‹•ç•«ã€‚</p>
      </div>

      <!-- Status Messages -->
      <div id="statusMessage" class="status-message"></div>

      <!-- Conversion Direction -->
      <div class="settings-panel">
        <h3 data-i18n="conversion_direction">è½‰æ›æ–¹å‘</h3>
        <div class="format-selector">
          <div class="format-option active" data-direction="extract" onclick="setDirection('extract')">
            <h4>GIF â†’ PNG/JPG</h4>
            <p data-i18n="extract_desc">å¾ GIF æå–æ‰€æœ‰å¹€</p>
          </div>
          <div class="format-option" data-direction="create" onclick="setDirection('create')">
            <h4>PNG/JPG â†’ GIF</h4>
            <p data-i18n="create_desc">åˆæˆå¤šåœ–ç‚º GIF å‹•ç•«</p>
          </div>
        </div>
      </div>

      <!-- Upload Area -->
      <div id="uploadArea" class="upload-area">
        <div class="icon">ğŸï¸</div>
        <h3 id="uploadTitle" data-i18n="upload_title_gif_extract">æ‹–æ”¾ GIF å‹•ç•«åˆ°æ­¤è™•</h3>
        <p data-i18n="upload_subtitle">æˆ–é»æ“Šé¸æ“‡æª”æ¡ˆ</p>
        <p id="uploadFormats" class="upload-formats" data-i18n="upload_formats_gif_extract">æ”¯æ´æ ¼å¼ï¼šGIF</p>
        <input type="file" id="fileInput" class="file-input" accept="image/gif">
      </div>

      <!-- Multi-file upload info (for create mode) -->
      <div id="multiUploadInfo" class="multi-upload-info" style="display: none;">
        <span data-i18n="multi_upload_tip">ğŸ’¡ æç¤ºï¼šå¯ä»¥ä¸€æ¬¡é¸æ“‡å¤šå¼µåœ–ç‰‡ï¼Œåœ–ç‰‡å°‡æŒ‰ç…§æª”åé †åºæ’åˆ—è£½ä½œæˆå‹•ç•«</span>
      </div>

      <!-- Settings Panel -->
      <div id="outputSettings" class="settings-panel">
        <h3 data-i18n="settings">è¼¸å‡ºè¨­å®š</h3>

        <!-- Output format (for extract mode) -->
        <div id="outputFormatRow" class="setting-row">
          <label data-i18n="output_format">è¼¸å‡ºæ ¼å¼</label>
          <select id="outputFormat" style="padding: 0.5rem; background: var(--bg-input); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary);">
            <option value="png">PNG (ç„¡æ)</option>
            <option value="jpg">JPG (æœ‰æ)</option>
          </select>
        </div>

        <!-- Quality slider (for JPG output) -->
        <div id="qualityRow" class="setting-row" style="display: none;">
          <label data-i18n="quality">å“è³ª</label>
          <input type="range" id="qualitySlider" min="1" max="100" value="92">
          <span id="qualityValue" class="quality-value">92%</span>
        </div>

        <!-- Frame delay (for create mode) -->
        <div id="delayRow" class="setting-row" style="display: none;">
          <label data-i18n="frame_delay">å¹€é–“éš”</label>
          <div class="delay-setting">
            <input type="number" id="frameDelay" value="100" min="10" max="5000">
            <span>ms</span>
          </div>
        </div>

        <!-- Loop setting (for create mode) -->
        <div id="loopRow" class="setting-row" style="display: none;">
          <label data-i18n="loop_count">å¾ªç’°æ¬¡æ•¸</label>
          <select id="loopCount" style="padding: 0.5rem; background: var(--bg-input); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary);">
            <option value="0" data-i18n="loop_infinite">ç„¡é™å¾ªç’°</option>
            <option value="1">1 æ¬¡</option>
            <option value="3">3 æ¬¡</option>
            <option value="5">5 æ¬¡</option>
          </select>
        </div>

        <div class="setting-row info-row">
          <span class="info-icon">â„¹ï¸</span>
          <span id="gifTip" data-i18n="gif_extract_tip">æå–å¾Œå¯é¸æ“‡è¦ä¸‹è¼‰çš„å¹€ï¼Œæˆ–ä¸‹è¼‰å…¨éƒ¨</span>
        </div>
      </div>

      <!-- Progress Bar -->
      <div id="progressContainer" class="progress-container">
        <div class="progress-bar">
          <div id="progressFill" class="progress-fill"></div>
        </div>
        <p id="progressText" class="progress-text" data-i18n="converting">è½‰æ›ä¸­...</p>
      </div>

      <!-- Preview Area (for extract mode - shows frames) -->
      <div id="framesArea" class="settings-panel" style="display: none;">
        <h3><span data-i18n="extracted_frames">æå–çš„å¹€</span> (<span id="frameCount">0</span>)</h3>
        <div id="framesGrid" class="frames-grid"></div>
        <div class="frame-controls">
          <button id="selectAllBtn" class="btn btn-secondary" onclick="selectAllFrames()">
            <span data-i18n="select_all">å…¨é¸</span>
          </button>
          <button id="deselectAllBtn" class="btn btn-secondary" onclick="deselectAllFrames()">
            <span data-i18n="deselect_all">å–æ¶ˆå…¨é¸</span>
          </button>
          <button id="downloadSelectedBtn" class="btn btn-success" style="display: none;">
            <span>â¬‡ï¸</span>
            <span data-i18n="download_selected">ä¸‹è¼‰é¸å–çš„å¹€</span>
          </button>
        </div>
      </div>

      <!-- Preview Area (for create mode - shows result) -->
      <div id="previewArea" class="preview-area" style="display: none;">
        <div class="preview-box">
          <div class="preview-header">
            <h4 data-i18n="source_images">ä¾†æºåœ–ç‰‡</h4>
            <span id="originalSize" class="file-size">-</span>
          </div>
          <div class="preview-image-container">
            <img id="originalImage" alt="Original">
          </div>
        </div>
        <div class="preview-box">
          <div class="preview-header">
            <h4 data-i18n="created_gif">è£½ä½œçš„ GIF</h4>
            <span id="convertedSize" class="file-size">-</span>
          </div>
          <div class="preview-image-container">
            <img id="convertedImage" alt="Converted GIF">
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button id="convertBtn" class="btn btn-primary" disabled>
          <span>ğŸ”„</span>
          <span id="convertText" data-i18n="extract_frames">æå–å¹€</span>
        </button>
        <button id="downloadBtn" class="btn btn-success" style="display: none;">
          <span>â¬‡ï¸</span>
          <span id="downloadText" data-i18n="download_all_frames">ä¸‹è¼‰å…¨éƒ¨å¹€</span>
        </button>
        <button id="resetBtn" class="btn btn-secondary" style="display: none;">
          <span>ğŸ—‘ï¸</span>
          <span data-i18n="reset">é‡ç½®</span>
        </button>
      </div>

      <!-- Performance Info -->
      <div id="performanceInfo" class="settings-panel" style="display: none;">
        <h3>ğŸ“Š æ•ˆèƒ½è³‡è¨Š</h3>
        <div class="setting-row">
          <label data-i18n="process_time">è™•ç†æ™‚é–“</label>
          <span id="processTime">-</span>
        </div>
        <div class="setting-row">
          <label data-i18n="frame_count_label">å¹€æ•¸</label>
          <span id="frameCountInfo">-</span>
        </div>
        <div class="setting-row">
          <label data-i18n="resolution">è§£æåº¦</label>
          <span id="imageResolution">-</span>
        </div>
      </div>
    </main>

    <footer class="footer">
      <p data-i18n="footer_privacy">æ‰€æœ‰æª”æ¡ˆè™•ç†å‡åœ¨æœ¬åœ°å®Œæˆï¼Œä¸æœƒä¸Šå‚³åˆ°ä¼ºæœå™¨</p>
    </footer>
  </div>

  <script type="module" src="/src/i18n/i18n.js"></script>
  <script type="module" src="./converter.js"></script>
</body>
</html>
