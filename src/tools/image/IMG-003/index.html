<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IMG-003 WebP è½‰æ›å™¨ - Awesome WASM Tools 1000</title>
  <meta name="description" content="WebP èˆ‡ PNG/JPG æ ¼å¼äº’è½‰ï¼Œæ”¯æ´å“è³ªèª¿æ•´èˆ‡ç„¡æå£“ç¸®">
  <link rel="stylesheet" href="/src/styles/global.css">
  <style>
    .format-selector {
      display: flex;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .format-option {
      flex: 1;
      padding: 1rem;
      background: var(--bg-input);
      border: 2px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      text-align: center;
      transition: all 0.2s;
    }
    .format-option:hover {
      border-color: var(--primary);
    }
    .format-option.active {
      border-color: var(--primary);
      background: rgba(99, 102, 241, 0.2);
    }
    .format-option h4 {
      margin-bottom: 0.25rem;
    }
    .format-option p {
      font-size: 0.85rem;
      color: var(--text-secondary);
    }
    .compression-toggle {
      display: flex;
      align-items: center;
      gap: 1rem;
      margin-bottom: 1rem;
    }
    .toggle-btn {
      padding: 0.5rem 1rem;
      background: var(--bg-input);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      color: var(--text-primary);
      cursor: pointer;
      transition: all 0.2s;
    }
    .toggle-btn.active {
      background: var(--primary);
      border-color: var(--primary);
    }
  </style>
</head>
<body>
  <div class="tool-page">
    <header class="tool-header">
      <a href="/index.html" class="back-btn">
        <span>â†</span>
        <span data-i18n="back">è¿”å›</span>
      </a>
      <div class="tool-title">
        <h1>IMG-003 <span data-i18n="img003_name">WebP è½‰æ›å™¨</span></h1>
        <p data-i18n="img003_desc">WebP èˆ‡ PNG/JPG æ ¼å¼äº’è½‰ï¼Œæ”¯æ´å“è³ªèª¿æ•´</p>
      </div>
      <div class="lang-switcher">
        <button onclick="setLanguage('zh-TW')" class="lang-btn">ç¹ä¸­</button>
        <button onclick="setLanguage('en')" class="lang-btn">EN</button>
      </div>
    </header>

    <main class="tool-content">
      <!-- Status Messages -->
      <div id="statusMessage" class="status-message"></div>

      <!-- Conversion Direction -->
      <div class="settings-panel">
        <h3 data-i18n="conversion_direction">è½‰æ›æ–¹å‘</h3>
        <div class="format-selector">
          <div class="format-option active" data-direction="to-webp" onclick="setDirection('to-webp')">
            <h4>PNG/JPG â†’ WebP</h4>
            <p data-i18n="to_webp_desc">è½‰æ›ç‚º WebP æ ¼å¼ï¼Œæª”æ¡ˆæ›´å°</p>
          </div>
          <div class="format-option" data-direction="from-webp" onclick="setDirection('from-webp')">
            <h4>WebP â†’ PNG/JPG</h4>
            <p data-i18n="from_webp_desc">è½‰æ›ç‚ºé€šç”¨æ ¼å¼</p>
          </div>
        </div>
      </div>

      <!-- Upload Area -->
      <div id="uploadArea" class="upload-area">
        <div class="icon">ğŸ“</div>
        <h3 id="uploadTitle" data-i18n="upload_title_webp_in">æ‹–æ”¾ PNG/JPG åœ–ç‰‡åˆ°æ­¤è™•</h3>
        <p data-i18n="upload_subtitle">æˆ–é»æ“Šé¸æ“‡æª”æ¡ˆ</p>
        <p id="uploadFormats" class="upload-formats" data-i18n="upload_formats_webp_in">æ”¯æ´æ ¼å¼ï¼šPNG, JPG, JPEG</p>
        <input type="file" id="fileInput" class="file-input" accept="image/png,image/jpeg,image/jpg">
      </div>

      <!-- Settings Panel -->
      <div id="outputSettings" class="settings-panel">
        <h3 data-i18n="settings">è¼¸å‡ºè¨­å®š</h3>

        <!-- Output format (for from-webp mode) -->
        <div id="outputFormatRow" class="setting-row" style="display: none;">
          <label data-i18n="output_format">è¼¸å‡ºæ ¼å¼</label>
          <select id="outputFormat" class="format-select" style="padding: 0.5rem; background: var(--bg-input); border: 1px solid var(--border); border-radius: 8px; color: var(--text-primary);">
            <option value="png">PNG (ç„¡æ)</option>
            <option value="jpg">JPG (æœ‰æ)</option>
          </select>
        </div>

        <!-- Compression type (for to-webp mode) -->
        <div id="compressionRow" class="setting-row">
          <label data-i18n="compression_type">å£“ç¸®æ¨¡å¼</label>
          <div class="compression-toggle">
            <button id="lossyBtn" class="toggle-btn active" onclick="setCompression('lossy')" data-i18n="lossy">æœ‰æå£“ç¸®</button>
            <button id="losslessBtn" class="toggle-btn" onclick="setCompression('lossless')" data-i18n="lossless">ç„¡æå£“ç¸®</button>
          </div>
        </div>

        <!-- Quality slider -->
        <div id="qualityRow" class="setting-row">
          <label data-i18n="quality">å“è³ª</label>
          <input type="range" id="qualitySlider" min="1" max="100" value="85">
          <span id="qualityValue" class="quality-value">85%</span>
        </div>

        <div class="setting-row info-row">
          <span class="info-icon">â„¹ï¸</span>
          <span id="compressionInfo" data-i18n="webp_lossy_info">æœ‰æå£“ç¸®å¯å¤§å¹…æ¸›å°‘æª”æ¡ˆå¤§å°ï¼Œé©åˆç¶²é ä½¿ç”¨</span>
        </div>
      </div>

      <!-- Progress Bar -->
      <div id="progressContainer" class="progress-container">
        <div class="progress-bar">
          <div id="progressFill" class="progress-fill"></div>
        </div>
        <p id="progressText" class="progress-text" data-i18n="converting">è½‰æ›ä¸­...</p>
      </div>

      <!-- Preview Area -->
      <div id="previewArea" class="preview-area" style="display: none;">
        <div class="preview-box">
          <div class="preview-header">
            <h4 data-i18n="original">åŸå§‹åœ–ç‰‡</h4>
            <span id="originalSize" class="file-size">-</span>
          </div>
          <div class="preview-image-container">
            <img id="originalImage" alt="Original">
          </div>
        </div>
        <div class="preview-box">
          <div class="preview-header">
            <h4 data-i18n="converted">è½‰æ›çµæœ</h4>
            <span id="convertedSize" class="file-size">-</span>
          </div>
          <div class="preview-image-container">
            <img id="convertedImage" alt="Converted">
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button id="convertBtn" class="btn btn-primary" disabled>
          <span>ğŸ”„</span>
          <span data-i18n="convert">é–‹å§‹è½‰æ›</span>
        </button>
        <button id="downloadBtn" class="btn btn-success" style="display: none;">
          <span>â¬‡ï¸</span>
          <span id="downloadText" data-i18n="download_webp">ä¸‹è¼‰ WebP</span>
        </button>
        <button id="resetBtn" class="btn btn-secondary" style="display: none;">
          <span>ğŸ—‘ï¸</span>
          <span data-i18n="reset">é‡ç½®</span>
        </button>
      </div>

      <!-- Performance Info -->
      <div id="performanceInfo" class="settings-panel" style="display: none;">
        <h3>ğŸ“Š æ•ˆèƒ½è³‡è¨Š</h3>
        <div class="setting-row">
          <label>è™•ç†æ™‚é–“</label>
          <span id="processTime">-</span>
        </div>
        <div class="setting-row">
          <label>æª”æ¡ˆè®ŠåŒ–</label>
          <span id="compressionRatio">-</span>
        </div>
        <div class="setting-row">
          <label>è§£æåº¦</label>
          <span id="imageResolution">-</span>
        </div>
      </div>
    </main>

    <footer class="footer">
      <p data-i18n="footer_privacy">æ‰€æœ‰æª”æ¡ˆè™•ç†å‡åœ¨æœ¬åœ°å®Œæˆï¼Œä¸æœƒä¸Šå‚³åˆ°ä¼ºæœå™¨</p>
    </footer>
  </div>

  <script type="module" src="/src/i18n/i18n.js"></script>
  <script type="module" src="./converter.js"></script>
</body>
</html>
